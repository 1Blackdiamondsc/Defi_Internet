var request=require("request"),fs=require("fs"),Promise=require("bluebird"),path=require("path");const Joi=require("@hapi/joi"),Lab=require("lab"),lab=exports.lab=Lab.script(),getConfigFile=function(e,r){try{return require(r+"/conf.my."+e+".json")}catch(t){return require(r+"/conf."+e+".json")}};var env=process.env.NODE_ENV;if(!env)throw"Please set NODE_ENV variable.";var conf=getConfigFile(env,"./"),agentOptions={};conf.tls&&conf.tls.cert&&(agentOptions.ca=fs.readFileSync(conf.tls.cert));var getClusterPostServer=function(){return conf.uri},joiokres=Joi.object().keys({ok:Joi.boolean().valid(!0),id:Joi.string(),rev:Joi.string()}),resetPassword=function(e){return new Promise(function(r,t){var n={url:getClusterPostServer()+"/auth/reset",method:"POST",json:e,agentOptions:agentOptions};request(n,function(e,n,o){e?t(e):r(o)})})};lab.experiment("Test clusterpost auth jwt",function(){var e={email:"algiedi85@gmail.com"};lab.test("returns true when an email is sent to the user with a link to reset the password",function(){return resetPassword(e).then(function(e){console.log(e)})})});