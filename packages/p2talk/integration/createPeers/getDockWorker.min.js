"use strict";const fs=require("fs"),path=require("path"),url=require("url"),crew=require("crew");let instance;const getDockWorker=function(e){if(instance)return process.nextTick(()=>{e(null,instance)});crew({host:url.parse(process.env.DOCKER_HOST).hostname,port:url.parse(process.env.DOCKER_HOST).port,keys:{privateKey:fs.readFileSync(path.join(process.env.DOCKER_CERT_PATH,"key.pem")),certificate:fs.readFileSync(path.join(process.env.DOCKER_CERT_PATH,"cert.pem")),caCertificate:fs.readFileSync(path.join(process.env.DOCKER_CERT_PATH,"ca.pem"))}},(r,s)=>{if(r)return e(r);s.ping(r=>r?e(r):e(null,instance=s))})};module.exports=getDockWorker;